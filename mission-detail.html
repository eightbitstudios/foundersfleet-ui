<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission Detail - FoundersFleet</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="boarding-pass-styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="missions-data.js"></script>
    <script src="nav-component.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#000000',
                        'primary-hover': '#333333',
                        'background': '#F8F9FA',
                        'card-bg': '#FFFFFF',
                        'text-primary': '#000000',
                        'text-secondary': '#666666',
                        'text-muted': '#999999',
                        'border': '#E5E5E5',
                        'section-bg': '#FAFAFA',
                        'success': '#10B981',
                        'warning': '#F59E0B',
                        'danger': '#EF4444'
                    },
                    borderRadius: {
                        'xl': '32px'
                    },
                    fontFamily: {
                        'inter': ['Inter', '-apple-system', 'BlinkMacSystemFont', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        /* Keep minimal custom styles for Tailwind config */
        .hidden { display: none !important; }
        
        /* Step connector line */
        .step-connector {
            position: absolute;
            left: 20px;
            top: 44px;
            bottom: 0;
            width: 2px;
            background: #E5E5E5;
        }
        
        .step-connector.completed {
            background: #000000;
        }
    </style>
</head>
<body class="bg-background min-h-screen font-inter flex">
    <!-- Navigation Placeholder -->
    <div id="nav-placeholder" style="width: 5rem; height: 100vh; background-color: #000000; position: sticky; top: 0; flex-shrink: 0;"></div>

    <!-- Main Content Area -->
    <div class="flex-1 bg-background overflow-hidden">
        <main class="h-full overflow-auto">
            <!-- Page Content -->
            <div class="max-w-[1200px] mx-auto px-8 py-8">
                <!-- Breadcrumb and Action Button -->
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center gap-2 text-sm text-text-secondary">
                        <a href="dashboard.html" class="underline hover:text-primary transition-all">Flight Plan</a>
                        <i class="fas fa-chevron-right text-xs"></i>
                        <a href="objective-detail.html?objective=launch-product" class="underline hover:text-primary transition-all">Launch Your Product</a>
                        <i class="fas fa-chevron-right text-xs"></i>
                        <span class="text-text-primary">Mission</span>
                    </div>
                    
                    <div class="relative">
                        <button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover transition-all" onclick="toggleDropdown()">
                            <span>Actions</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div id="action-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white border border-border rounded-lg shadow-lg z-10">
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all">
                                <i class="fas fa-bookmark mr-2"></i>Save Progress
                            </a>
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all">
                                <i class="fas fa-share mr-2"></i>Share Mission
                            </a>
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all">
                                <i class="fas fa-flag mr-2"></i>Mark Complete
                            </a>
                            <div class="border-t border-border"></div>
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all">
                                <i class="fas fa-undo mr-2"></i>Reset Progress
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Mission Header -->
                <div class="mb-8">
                    <div class="flex items-start gap-4">
                        <div id="mission-icon" class="w-12 h-12 bg-primary rounded-lg flex items-center justify-center">
                            <i class="fas fa-rocket text-white text-xl"></i>
                        </div>
                        <div>
                            <h1 id="mission-title" class="text-2xl font-bold text-text-primary">Loading...</h1>
                            <p id="mission-description" class="text-text-secondary mt-1">Loading mission details...</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Left Column - Main Content -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Mission Overview -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h2 class="text-lg font-semibold text-text-primary mb-4">Mission Overview</h2>
                            
                            <div class="grid grid-cols-3 gap-4 mb-6">
                                <div class="text-center p-3 bg-section-bg rounded-lg">
                                    <i class="fas fa-clock text-warning mb-2"></i>
                                    <p class="text-xs text-text-secondary">Time Required</p>
                                    <p id="mission-time" class="text-sm font-semibold text-text-primary">-</p>
                                </div>
                                <div class="text-center p-3 bg-section-bg rounded-lg">
                                    <i class="fas fa-signal text-danger mb-2"></i>
                                    <p class="text-xs text-text-secondary">Difficulty</p>
                                    <p id="mission-difficulty" class="text-sm font-semibold text-text-primary">-</p>
                                </div>
                                <div class="text-center p-3 bg-section-bg rounded-lg">
                                    <i class="fas fa-dollar-sign text-success mb-2"></i>
                                    <p class="text-xs text-text-secondary">Cost</p>
                                    <p id="mission-cost" class="text-sm font-semibold text-text-primary">-</p>
                                </div>
                            </div>
                            
                            <div id="mission-overview" class="prose prose-sm text-text-secondary">
                                <p>Loading mission overview...</p>
                            </div>
                        </div>

                        <!-- Mission Steps -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <div class="flex items-center justify-between mb-6">
                                <h2 class="text-lg font-semibold text-text-primary">Mission Checkpoints</h2>
                                <div class="text-right">
                                    <p id="checkpoint-status" class="text-sm font-medium text-text-primary">Loading...</p>
                                </div>
                            </div>
                            
                            <div id="mission-steps" class="space-y-0">
                                <!-- Steps will be dynamically loaded here -->
                            </div>
                        </div>

                        <!-- Discussion -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h2 class="text-lg font-semibold text-text-primary mb-4">Discussion</h2>
                            
                            <div class="space-y-4">
                                <!-- Comment -->
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                                        <span class="text-white text-xs font-medium">JK</span>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-baseline gap-2">
                                            <span class="font-medium text-sm text-text-primary">James Kim</span>
                                            <span class="text-xs text-text-muted">2 hours ago</span>
                                        </div>
                                        <p class="text-sm text-text-secondary mt-1">Pro tip: Make sure your DUNS number exactly matches your business registration. Even small differences can cause delays!</p>
                                    </div>
                                </div>
                                
                                <!-- Add comment -->
                                <div class="flex gap-3 pt-4 border-t border-border">
                                    <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                                        <span class="text-white text-xs font-medium">SC</span>
                                    </div>
                                    <div class="flex-1">
                                        <input type="text" placeholder="Add a comment or question..." class="w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column - Support -->
                    <div class="space-y-6">
                        <!-- Mission Info -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="font-semibold text-text-primary mb-4">Mission Info</h3>
                            
                            <div class="space-y-3">
                                <div>
                                    <p class="text-xs text-text-muted uppercase mb-1">Epic</p>
                                    <p class="text-sm font-medium text-text-primary">Launch Your Product</p>
                                </div>
                                <div>
                                    <p class="text-xs text-text-muted uppercase mb-1">Category</p>
                                    <p class="text-sm font-medium text-text-primary">Technical Setup</p>
                                </div>
                                <div>
                                    <p class="text-xs text-text-muted uppercase mb-1">Prerequisites</p>
                                    <p class="text-sm text-text-secondary">Business entity formed</p>
                                </div>
                            </div>
                        </div>

                        <!-- Founders Who Completed -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="font-semibold text-text-primary mb-4">Completed by</h3>
                            <p class="text-xs text-text-secondary mb-4">23 founders completed this mission</p>
                            
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                        <span class="text-white text-xs font-medium">AR</span>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm font-medium text-text-primary truncate">Aisha Robinson</p>
                                        <p class="text-xs text-text-secondary">2 weeks ago</p>
                                    </div>
                                    <button class="text-xs text-primary hover:text-primary-hover">Ask</button>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                        <span class="text-white text-xs font-medium">MP</span>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm font-medium text-text-primary truncate">Marcus Park</p>
                                        <p class="text-xs text-text-secondary">1 month ago</p>
                                    </div>
                                    <button class="text-xs text-primary hover:text-primary-hover">Ask</button>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                        <span class="text-white text-xs font-medium">SC</span>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm font-medium text-text-primary truncate">Sarah Chen</p>
                                        <p class="text-xs text-text-secondary">2 months ago</p>
                                    </div>
                                    <button class="text-xs text-primary hover:text-primary-hover">Ask</button>
                                </div>
                            </div>
                            
                            <button class="w-full mt-4 text-xs text-primary hover:text-primary-hover">View all →</button>
                        </div>

                        <!-- Members Here -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="font-semibold text-text-primary mb-4">Members Here</h3>
                            <p class="text-xs text-text-secondary mb-4">12 founders working on this mission</p>
                            
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">JK</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-primary rounded-full flex items-center justify-center" title="Squad member">
                                            <i class="fas fa-users text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm font-medium text-text-primary truncate">James Kim</p>
                                        <p class="text-xs text-text-secondary">3/5 checkpoints</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">MP</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-primary rounded-full flex items-center justify-center" title="Squad member">
                                            <i class="fas fa-users text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm font-medium text-text-primary truncate">Maya Patel</p>
                                        <p class="text-xs text-text-secondary">2/5 checkpoints</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">AR</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center" title="Connection">
                                            <i class="fas fa-link text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm font-medium text-text-primary truncate">Alex Rivera</p>
                                        <p class="text-xs text-text-secondary">1/5 checkpoints</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center">
                                        <span class="text-white text-xs font-medium">LT</span>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm font-medium text-text-primary truncate">Lisa Thompson</p>
                                        <p class="text-xs text-text-secondary">Just started</p>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="text-xs text-primary hover:text-primary-hover mt-3 inline-block">View all 12 members →</button>
                        </div>

                        <!-- Recommended Apps -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="font-semibold text-text-primary mb-4">Helpful Apps</h3>
                            <div class="space-y-3">
                                <a href="tool-detail-economaestro.html" class="flex items-center gap-3 p-3 bg-purple-50 border border-purple-200 rounded hover:bg-purple-100 transition-all group">
                                    <i class="fas fa-chart-line text-purple-600"></i>
                                    <div class="flex-1">
                                        <span class="text-sm font-medium text-text-primary">EconoMaestro</span>
                                        <p class="text-xs text-text-secondary">App store timing insights</p>
                                    </div>
                                </a>
                            </div>
                            <a href="apps.html" class="text-xs text-primary hover:text-primary-hover mt-3 inline-block">Browse all apps →</a>
                        </div>

                        <!-- Resources -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="font-semibold text-text-primary mb-4">Resources</h3>
                            
                            <div class="space-y-3">
                                <a href="#" class="flex items-center gap-3 text-text-secondary hover:text-primary transition-all">
                                    <i class="fas fa-external-link-alt text-text-muted text-sm"></i>
                                    <span class="text-sm">Apple Developer Portal</span>
                                </a>
                                <a href="#" class="flex items-center gap-3 text-text-secondary hover:text-primary transition-all">
                                    <i class="fas fa-file-pdf text-text-muted text-sm"></i>
                                    <span class="text-sm">Verification Checklist</span>
                                </a>
                                <a href="#" class="flex items-center gap-3 text-text-secondary hover:text-primary transition-all">
                                    <i class="fas fa-video text-text-muted text-sm"></i>
                                    <span class="text-sm">Video Walkthrough</span>
                                </a>
                            </div>
                        </div>

                        <!-- Related Missions -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="font-semibold text-text-primary mb-4">Next Missions</h3>
                            
                            <div class="space-y-3">
                                <div class="p-3 border border-border rounded hover:border-primary transition-all cursor-pointer">
                                    <h4 class="text-sm font-medium text-text-primary">Configure App Store Connect</h4>
                                    <p class="text-xs text-text-secondary mt-1">Set up your app listing</p>
                                </div>
                                <div class="p-3 border border-border rounded hover:border-primary transition-all cursor-pointer">
                                    <h4 class="text-sm font-medium text-text-primary">Implement Push Notifications</h4>
                                    <p class="text-xs text-text-secondary mt-1">Configure certificates and entitlements</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
    <script>
        // Initialize navigation
        initializeNavigation('dashboard');
        
        // Load mission data based on URL parameter
        function loadMissionData() {
            const urlParams = new URLSearchParams(window.location.search);
            const missionId = urlParams.get('mission');
            
            if (!missionId || !missionData || !missionData.missions || !missionData.missions[missionId]) {
                // Default to a mission if none specified or not found
                document.getElementById('mission-title').textContent = 'Mission Not Found';
                document.getElementById('mission-description').textContent = 'The requested mission could not be found.';
                return;
            }
            
            const mission = missionData.missions[missionId];
            
            // Update page title
            document.title = `Mission: ${mission.title} - FoundersFleet`;
            
            // Update mission header
            document.getElementById('mission-icon').innerHTML = `<i class="fas ${mission.icon || 'fa-rocket'} text-white text-xl"></i>`;
            document.getElementById('mission-title').textContent = mission.title;
            document.getElementById('mission-description').textContent = mission.description;
            
            // Update mission stats
            document.getElementById('mission-time').textContent = mission.timeEstimate || 'Variable';
            document.getElementById('mission-difficulty').textContent = mission.difficulty ? mission.difficulty.charAt(0).toUpperCase() + mission.difficulty.slice(1) : 'Medium';
            document.getElementById('mission-cost').textContent = mission.cost === 0 ? 'Free' : `$${mission.cost}${mission.cost === 99 ? '/year' : ''}`;
            
            // Update mission overview
            const overviewText = getOverviewText(missionId, mission);
            document.getElementById('mission-overview').innerHTML = `<p>${overviewText}</p>`;
            
            // Update checkpoint status
            const totalSteps = mission.steps ? mission.steps.length : 0;
            const completedSteps = Math.floor(Math.random() * totalSteps); // Simulated progress
            document.getElementById('checkpoint-status').textContent = `${completedSteps} of ${totalSteps} complete`;
            
            // Load mission steps
            loadMissionSteps(mission.steps || [], completedSteps);
            
            // Update breadcrumb
            updateBreadcrumb(mission);
        }
        
        function getOverviewText(missionId, mission) {
            const overviews = {
                'apple-dev-account': 'Setting up an Apple Developer Account is more complex than most founders expect. Apple\'s verification process is thorough and can take weeks. This mission guides you through each step to avoid common pitfalls that can delay your app launch.',
                'validate-idea': 'Validating your idea is the most crucial step in your founder journey. This mission will help you talk to real potential customers and validate that you\'re solving a real problem worth solving.',
                'customer-interviews': 'Deep customer interviews help you understand not just what customers say they want, but what they actually need. This mission guides you through conducting effective interviews that reveal true insights.',
                'go-to-market-strategy': 'A well-crafted go-to-market strategy is essential for a successful product launch. This mission helps you define your target segments, choose distribution channels, set pricing, and create a launch timeline.'
            };
            
            return overviews[missionId] || `Complete this mission to ${mission.description.toLowerCase()}. Follow each checkpoint carefully to ensure success.`;
        }
        
        function loadMissionSteps(steps, completedCount) {
            const container = document.getElementById('mission-steps');
            container.innerHTML = '';
            
            steps.forEach((step, index) => {
                const isCompleted = index < completedCount;
                const isCurrent = index === completedCount;
                const isLocked = index > completedCount;
                
                const stepDiv = document.createElement('div');
                stepDiv.className = 'relative';
                
                let statusIcon = '';
                let statusClass = '';
                
                if (isCompleted) {
                    statusIcon = '<i class="fas fa-check text-white text-sm"></i>';
                    statusClass = 'bg-success';
                } else if (isCurrent) {
                    statusIcon = `<span class="text-white font-bold">${index + 1}</span>`;
                    statusClass = 'bg-warning ring-4 ring-warning/20';
                } else {
                    statusIcon = `<span class="text-text-muted font-bold">${index + 1}</span>`;
                    statusClass = 'bg-section-bg';
                }
                
                stepDiv.innerHTML = `
                    <div class="flex gap-4">
                        <div class="relative z-10">
                            <div class="w-10 h-10 ${statusClass} rounded-full flex items-center justify-center">
                                ${statusIcon}
                            </div>
                        </div>
                        <div class="flex-1 ${index < steps.length - 1 ? 'pb-8' : ''}">
                            <h3 class="font-semibold ${isLocked ? 'text-text-secondary' : 'text-text-primary'}">${step.title}</h3>
                            <p class="text-sm ${isLocked ? 'text-text-muted' : 'text-text-secondary'} mt-1">${step.description}</p>
                            ${isCompleted ? `
                                <div class="mt-3 p-3 bg-success/10 rounded-lg">
                                    <p class="text-xs text-success font-medium">Completed</p>
                                </div>
                            ` : isCurrent ? `
                                <div class="mt-4 flex gap-2">
                                    <button class="px-4 py-2 bg-primary text-white rounded hover:bg-primary-hover transition-all text-sm font-medium">
                                        <i class="fas fa-check mr-2"></i>Mark as Done
                                    </button>
                                    <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all text-sm font-medium">
                                        <i class="fas fa-forward mr-2"></i>Skip
                                    </button>
                                </div>
                            ` : isLocked ? `
                                <p class="text-xs text-text-muted mt-2 italic">Complete previous checkpoint to unlock</p>
                            ` : ''}
                        </div>
                    </div>
                    ${index < steps.length - 1 ? `<div class="step-connector ${isCompleted ? 'completed' : ''}"></div>` : ''}
                `;
                
                container.appendChild(stepDiv);
            });
        }
        
        function updateBreadcrumb(mission) {
            // Update the breadcrumb to show the correct objective
            const objectiveLink = document.querySelector('a[href*="objective-detail.html"]');
            if (objectiveLink) {
                // Map mission epic to objective
                const epicToObjective = {
                    'starting-out': { id: 'idea-validation', name: 'Idea Validation' },
                    'first-customers': { id: 'growth-traction', name: 'Growth & Traction' },
                    'launch-product': { id: 'launch-product', name: 'Launch Your Product' },
                    'fundraise': { id: 'fundraising', name: 'Fundraising' }
                };
                
                const objective = epicToObjective[mission.epic];
                if (objective) {
                    objectiveLink.href = `objective-detail.html?objective=${objective.id}`;
                    objectiveLink.textContent = objective.name;
                }
            }
        }
        
        // Toggle action dropdown
        function toggleDropdown() {
            const dropdown = document.getElementById('action-dropdown');
            dropdown.classList.toggle('hidden');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('action-dropdown');
            const button = event.target.closest('button[onclick="toggleDropdown()"]');
            
            if (!button && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });
        
        // Load mission data when page loads
        window.addEventListener('DOMContentLoaded', function() {
            loadMissionData();
        });

    </script>
</body>
</html>