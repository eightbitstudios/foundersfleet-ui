<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Objective Detail - FoundersFleet</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="boarding-pass-styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="missions-data.js"></script>
    <script src="nav-component.js"></script>
    <script src="notifications-component.js"></script>
    <script src="search-component.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#000000',
                        'primary-hover': '#333333',
                        'background': '#F8F9FA',
                        'card-bg': '#FFFFFF',
                        'text-primary': '#000000',
                        'text-secondary': '#666666',
                        'text-muted': '#999999',
                        'border': '#E5E5E5',
                        'section-bg': '#FAFAFA',
                        'success': '#10B981',
                        'warning': '#F59E0B',
                        'danger': '#EF4444',
                        'info': '#3B82F6'
                    },
                    borderRadius: {
                        'xl': '32px'
                    },
                    fontFamily: {
                        'inter': ['Inter', '-apple-system', 'BlinkMacSystemFont', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        .hidden { display: none !important; }
    </style>
</head>
<body class="bg-background min-h-screen font-inter flex">
    <!-- Navigation Placeholder -->
    <div id="nav-placeholder" style="width: 5rem; height: 100vh; background-color: #000000; position: sticky; top: 0; flex-shrink: 0;"></div>

    <!-- Main Content Area -->
    <div class="flex-1 bg-background overflow-hidden">
        <main class="h-full overflow-auto">
            <!-- Page Content -->
            <div class="max-w-[1200px] mx-auto px-8 py-8">
                <!-- Breadcrumb and Action Button -->
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center gap-2 text-sm text-text-secondary">
                        <a href="flightplan.html" class="underline hover:text-primary transition-all">Flight Plan</a>
                        <i class="fas fa-chevron-right text-xs"></i>
                        <span class="text-text-primary">Objective</span>
                    </div>
                    
                    <div class="relative">
                        <button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover transition-all" onclick="toggleDropdown()">
                            <span>Actions</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div id="action-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white border border-border rounded-lg shadow-lg z-10">
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all">
                                <i class="fas fa-edit mr-2"></i>Edit Objective
                            </a>
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all">
                                <i class="fas fa-share mr-2"></i>Share Progress
                            </a>
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all">
                                <i class="fas fa-archive mr-2"></i>Archive
                            </a>
                            <div class="border-t border-border"></div>
                            <a href="#" class="block px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-all" onclick="event.preventDefault(); openSuggestionModal()">
                                <i class="fas fa-lightbulb mr-2"></i>Suggest New Mission
                            </a>
                            <div class="border-t border-border"></div>
                            <a href="#" class="block px-4 py-2 text-sm text-danger hover:bg-gray-50 transition-all">
                                <i class="fas fa-trash mr-2"></i>Remove from Plan
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Objective Overview -->
                <div class="bg-card-bg border border-border rounded-lg p-8 mb-8">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2">
                            <!-- Icon and Title on same line -->
                            <div class="flex items-center gap-3 mb-3">
                                <div id="objective-icon" class="w-8 h-8 bg-black rounded-lg flex items-center justify-center flex-shrink-0">
                                    <i class="fas fa-lightbulb text-sm text-white"></i>
                                </div>
                                <h2 id="objective-title" class="text-2xl font-bold text-text-primary">Idea Validation</h2>
                            </div>
                            <p id="objective-description" class="text-text-secondary mb-6">Research, validate, and refine your concept to ensure you're solving a real problem that people will pay for.</p>
                            <!-- Mission status in lower left -->
                            <p class="text-lg text-text-primary font-medium">2/4 Missions Complete</p>
                        </div>
                        
                        <!-- Estimated time in gray box on right -->
                        <div class="flex items-center">
                            <div class="bg-section-bg rounded-lg px-8 py-6 text-center w-full">
                                <p class="text-2xl font-bold text-text-primary mb-2">2-4 weeks</p>
                                <p class="text-sm text-text-secondary uppercase tracking-wide">Estimated Time</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Left Column - Missions -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Missions Section -->
                        <div>
                            <div class="flex items-center gap-4 mb-6">
                                <button id="active-filter" onclick="filterMissions('active')" class="px-4 py-2 bg-primary text-white rounded-lg transition-all">
                                    Active Missions
                                </button>
                                <button id="completed-filter" onclick="filterMissions('completed')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all">
                                    Completed Missions
                                </button>
                            </div>
                            <div class="space-y-4" id="missions-container">
                                <!-- Mission cards will be dynamically loaded here -->
                            </div>
                        </div>

                    </div>

                    <!-- Right Column - Support & Stats -->
                    <div class="space-y-6">
                        <!-- Completed by -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-2">Completed by</h3>
                            <p class="text-sm text-text-secondary mb-4">5 founders completed this Objective</p>
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">SC</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-primary rounded-full flex items-center justify-center" title="Squad member">
                                            <i class="fas fa-users text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <a href="founder-profile.html?founder=sarah-chen" class="text-sm font-medium text-text-primary hover:text-primary transition-all">Sarah Chen</a>
                                        <p class="text-xs text-success">Completed 2 weeks ago</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">AR</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center" title="Connection">
                                            <i class="fas fa-link text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <a href="founder-profile.html?founder=alex-rivera" class="text-sm font-medium text-text-primary hover:text-primary transition-all">Alex Rivera</a>
                                        <p class="text-xs text-success">Completed 1 month ago</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center">
                                        <span class="text-white text-xs font-medium">TM</span>
                                    </div>
                                    <div class="flex-1">
                                        <a href="founder-profile.html?founder=tyler-morris" class="text-sm font-medium text-text-primary hover:text-primary transition-all">Tyler Morris</a>
                                        <p class="text-xs text-success">Completed 3 months ago</p>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="w-full mt-4 text-xs text-primary hover:text-primary-hover">
                                View all 5 founders →
                            </button>
                        </div>
                        
                        <!-- Members Here -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-2">Members Here</h3>
                            <p class="text-sm text-text-secondary mb-4">15 founders have this as a top objective</p>
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">JK</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-primary rounded-full flex items-center justify-center" title="Squad member">
                                            <i class="fas fa-users text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <a href="founder-profile.html?founder=james-kim" class="text-sm font-medium text-text-primary hover:text-primary transition-all">James Kim</a>
                                        <p class="text-xs text-text-secondary">Customer Interviews - 3/10</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">MP</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-primary rounded-full flex items-center justify-center" title="Squad member">
                                            <i class="fas fa-users text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <a href="founder-profile.html?founder=maya-patel" class="text-sm font-medium text-text-primary hover:text-primary transition-all">Maya Patel</a>
                                        <p class="text-xs text-text-secondary">Market Research - Completed</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="relative">
                                        <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs font-medium">LT</span>
                                        </div>
                                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center" title="Connection">
                                            <i class="fas fa-link text-white" style="font-size: 8px;"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <a href="founder-profile.html?founder=lisa-thompson" class="text-sm font-medium text-text-primary hover:text-primary transition-all">Lisa Thompson</a>
                                        <p class="text-xs text-text-secondary">Mom Test - Starting</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-orange-600 rounded-full flex items-center justify-center">
                                        <span class="text-white text-xs font-medium">NK</span>
                                    </div>
                                    <div class="flex-1">
                                        <a href="founder-profile.html?founder=nina-kaur" class="text-sm font-medium text-text-primary hover:text-primary transition-all">Nina Kaur</a>
                                        <p class="text-xs text-text-secondary">Landing Page - In Progress</p>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="w-full mt-4 px-3 py-2 bg-section-bg text-text-primary rounded hover:bg-primary hover:text-white transition-all text-sm">
                                <i class="fas fa-comments mr-2"></i>Start Discussion
                            </button>
                        </div>

                        <!-- Objective Benefits -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-4">Why This Objective Matters</h3>
                            <div class="space-y-3">
                                <div class="flex items-start gap-3">
                                    <i class="fas fa-check-circle text-success mt-0.5"></i>
                                    <p class="text-sm text-text-secondary">Avoid building something nobody wants</p>
                                </div>
                                <div class="flex items-start gap-3">
                                    <i class="fas fa-check-circle text-success mt-0.5"></i>
                                    <p class="text-sm text-text-secondary">Save time and money by validating early</p>
                                </div>
                                <div class="flex items-start gap-3">
                                    <i class="fas fa-check-circle text-success mt-0.5"></i>
                                    <p class="text-sm text-text-secondary">Build confidence in your direction</p>
                                </div>
                                <div class="flex items-start gap-3">
                                    <i class="fas fa-check-circle text-success mt-0.5"></i>
                                    <p class="text-sm text-text-secondary">Attract early supporters and advisors</p>
                                </div>
                            </div>
                        </div>

                        <!-- Recommended Apps -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-4">Recommended Apps</h3>
                            <div class="space-y-3">
                                <a href="tool-detail-economaestro.html" class="flex items-center gap-3 p-3 bg-purple-50 border border-purple-200 rounded hover:bg-purple-100 transition-all group">
                                    <i class="fas fa-chart-line text-purple-600"></i>
                                    <div class="flex-1">
                                        <span class="text-sm font-medium text-text-primary">EconoMaestro</span>
                                        <p class="text-xs text-text-secondary">Time your market entry</p>
                                    </div>
                                </a>
                                <a href="apps.html" class="flex items-center gap-3 p-3 bg-section-bg rounded hover:bg-primary hover:text-white transition-all group">
                                    <i class="fas fa-rocket text-primary group-hover:text-white"></i>
                                    <div class="flex-1">
                                        <span class="text-sm text-text-primary group-hover:text-white">Product Tracker</span>
                                        <p class="text-xs text-text-secondary group-hover:text-white/80">Coming Soon</p>
                                    </div>
                                </a>
                            </div>
                            <a href="apps.html" class="text-xs text-primary hover:text-primary-hover mt-3 inline-block">View all apps →</a>
                        </div>

                        <!-- Recommended Tools -->
                        <div class="bg-card-bg border border-border rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-4">Recommended Tools</h3>
                            <div class="space-y-3">
                                <a href="tools.html" class="flex items-center gap-3 p-3 bg-section-bg rounded hover:bg-primary hover:text-white transition-all group">
                                    <i class="fas fa-poll text-primary group-hover:text-white"></i>
                                    <span class="text-sm">Survey Tools</span>
                                </a>
                                <a href="tools.html" class="flex items-center gap-3 p-3 bg-section-bg rounded hover:bg-primary hover:text-white transition-all group">
                                    <i class="fas fa-calendar text-primary group-hover:text-white"></i>
                                    <span class="text-sm">Interview Scheduling</span>
                                </a>
                                <a href="tools.html" class="flex items-center gap-3 p-3 bg-section-bg rounded hover:bg-primary hover:text-white transition-all group">
                                    <i class="fas fa-sticky-note text-primary group-hover:text-white"></i>
                                    <span class="text-sm">Note Taking Apps</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
    <script>
        // Filter missions by status - moved to top for availability
        let currentFilter = 'active';
        
        // Objective data
        const objectiveData = {
            'idea-validation': {
                title: 'Idea Validation',
                icon: 'fa-lightbulb',
                description: 'Research, validate, and refine your concept to ensure you\'re solving a real problem that people will pay for.',
                missions: ['validate-idea', 'problem-survey', 'landing-page', 'social-media-test', 'no-code-prototype', 'competitor-analysis'],
                progress: 2,
                total: 6,
                estimatedTime: '2-4 weeks'
            },
            'mvp-development': {
                title: 'MVP Development',
                icon: 'fa-code',
                description: 'Build and launch your first version to test with real users and gather feedback.',
                missions: ['product-requirements-doc', 'choose-tech-stack', 'design-mockups', 'dev-environment-setup', 'github-setup', 'build-mvp'],
                progress: 1,
                total: 6,
                estimatedTime: '1-2 months'
            },
            'operations-legal': {
                title: 'Operations & Legal',
                icon: 'fa-shield-alt',
                description: 'Set up your business foundation with proper legal structure and operational systems.',
                missions: ['business-entity', 'stripe-setup', 'security-audit', 'analytics-setup'],
                progress: 0,
                total: 4,
                estimatedTime: '2-3 weeks'
            },
            'growth-traction': {
                title: 'Growth & Traction',
                icon: 'fa-chart-line',
                description: 'Scale your user base and revenue through systematic growth experiments.',
                missions: ['analytics-setup', 'landing-page', 'customer-interviews', 'launch-product-hunt'],
                progress: 0,
                total: 4,
                estimatedTime: '4-6 weeks'
            },
            'fundraising': {
                title: 'Fundraising',
                icon: 'fa-hand-holding-usd',
                description: 'Prepare for and successfully raise investment to fuel your growth.',
                missions: ['business-entity', 'analytics-setup', 'validate-idea', 'customer-interviews'],
                progress: 0,
                total: 4,
                estimatedTime: '6-8 weeks'
            },
            'team-building': {
                title: 'Team Building',
                icon: 'fa-users',
                description: 'Hire and manage your team to build a strong company culture.',
                missions: ['github-setup', 'security-audit', 'analytics-setup', 'business-entity'],
                progress: 0,
                total: 5,
                estimatedTime: '3-4 weeks'
            },
            'launch-product': {
                title: 'Launch Your Product',
                icon: 'fa-rocket',
                description: 'Ship your product to the world with all the necessary infrastructure and distribution channels.',
                missions: ['go-to-market-strategy', 'apple-dev-account', 'launch-product-hunt', 'landing-page', 'stripe-setup'],
                progress: 0,
                total: 5,
                estimatedTime: '3-4 weeks'
            },
            'product-launch': {
                title: 'Product Launch',
                icon: 'fa-rocket',
                description: 'Launch your product with maximum impact through strategic planning and execution.',
                missions: ['launch-product-hunt', 'landing-page', 'analytics-setup', 'stripe-setup'],
                progress: 0,
                total: 4,
                estimatedTime: '2-3 weeks'
            },
            'scale-optimize': {
                title: 'Scale & Optimize',
                icon: 'fa-expand-arrows-alt',
                description: 'Optimize your operations for sustainable growth and expansion.',
                missions: ['process-automation', 'performance-optimization', 'cost-optimization', 'analytics-setup', 'security-audit', 'infrastructure-scaling', 'monitoring-setup'],
                progress: 0,
                total: 7,
                estimatedTime: '4-6 weeks'
            },
            'customer-success': {
                title: 'Customer Success',
                icon: 'fa-heart',
                description: 'Build systems to delight and retain customers throughout their journey.',
                missions: ['customer-onboarding', 'support-system', 'feedback-loops', 'customer-health-tracking', 'retention-strategies', 'community-building'],
                progress: 0,
                total: 6,
                estimatedTime: '3-5 weeks'
            },
            'marketing-branding': {
                title: 'Marketing & Branding',
                icon: 'fa-bullhorn',
                description: 'Build your brand identity and reach your target audience effectively.',
                missions: ['brand-identity', 'content-strategy', 'social-media-setup', 'email-marketing', 'seo-optimization', 'paid-advertising', 'influencer-outreach', 'pr-strategy'],
                progress: 0,
                total: 8,
                estimatedTime: '4-6 weeks'
            },
            'sales-process': {
                title: 'Sales Process',
                icon: 'fa-handshake',
                description: 'Create repeatable sales systems to drive consistent revenue growth.',
                missions: ['sales-playbook', 'crm-setup', 'lead-qualification', 'demo-process', 'pricing-strategy', 'sales-collateral', 'pipeline-management'],
                progress: 0,
                total: 7,
                estimatedTime: '3-5 weeks'
            },
            'data-analytics': {
                title: 'Data & Analytics',
                icon: 'fa-chart-bar',
                description: 'Make data-driven decisions with comprehensive analytics and insights.',
                missions: ['analytics-setup', 'kpi-dashboard', 'data-warehouse', 'reporting-automation', 'ab-testing-framework'],
                progress: 0,
                total: 5,
                estimatedTime: '3-4 weeks'
            },
            'international-expansion': {
                title: 'International Expansion',
                icon: 'fa-globe',
                description: 'Take your product global with strategic international growth.',
                missions: ['market-research-international', 'localization-strategy', 'international-legal', 'currency-payment-setup', 'international-shipping', 'local-partnerships', 'cultural-adaptation', 'international-marketing', 'global-support'],
                progress: 0,
                total: 9,
                estimatedTime: '6-8 weeks'
            }
        };

        // Initialize page when DOM is ready
        function initializePage() {
            // Get objective from URL
            const urlParams = new URLSearchParams(window.location.search);
            const objectiveId = urlParams.get('objective') || 'idea-validation';
            const objective = objectiveData[objectiveId];

            // Update page content
            if (objective) {
                // Breadcrumb removed - no longer needed
                document.getElementById('objective-icon').innerHTML = `<i class="fas ${objective.icon} text-sm text-white"></i>`;
                document.getElementById('objective-title').textContent = objective.title;
                document.getElementById('objective-description').textContent = objective.description;
                
                // Update mission status in lower left
                const missionStatusDisplay = document.querySelector('.lg\\:col-span-2 p.text-lg');
                if (missionStatusDisplay) {
                    missionStatusDisplay.textContent = `${objective.progress}/${objective.total} Missions Complete`;
                }
                
                // Update estimated time in gray box
                const timeDisplay = document.querySelector('.bg-section-bg p.text-2xl');
                if (timeDisplay) {
                    timeDisplay.textContent = objective.estimatedTime || '2-4 weeks';
                }
                
                // Load missions
                loadMissions(objective.missions, objective);
            }
        }
        
        // Call initialization immediately
        initializePage();

        function loadMissions(missionIds, objective) {
            const container = document.getElementById('missions-container');
            container.innerHTML = '';
            
            
            // If missionData is not available yet, wait and retry
            if (typeof missionData === 'undefined' || !missionData || !missionData.missions) {
                console.log('Mission data not loaded yet, retrying...');
                setTimeout(() => loadMissions(missionIds, objective), 500);
                return;
            }
            
            missionIds.forEach((missionId, index) => {
                const mission = missionData.missions[missionId];
                if (mission) {
                    const isCompleted = index < objective.progress;
                    const isActive = index === objective.progress;
                    const isLocked = index > objective.progress;
                    
                    // Filter based on current filter
                    // Active = not completed (includes in-progress and locked/not started)
                    // Completed = only completed missions
                    if (currentFilter === 'active' && isCompleted) return;
                    if (currentFilter === 'completed' && !isCompleted) return;
                    
                    const missionCard = document.createElement('div');
                    missionCard.className = `bg-card-bg border ${isLocked ? 'border-dashed border-gray-300' : 'border-border'} rounded-lg p-6 hover:shadow-md cursor-pointer transition-all`;
                    missionCard.onclick = () => window.location.href = `mission-detail.html?mission=${missionId}`;
                    
                    // Determine checkpoint status
                    let checkpointText = '';
                    let statusBadge = '';
                    if (isCompleted) {
                        statusBadge = '<span class="text-xs px-2 py-1 bg-success/10 text-success rounded-full font-medium">Completed</span>';
                    } else if (isActive) {
                        // For active missions, show checkpoint progress (example: 3/5)
                        checkpointText = '<span class="text-xs px-2 py-1 bg-warning/10 text-warning rounded-full font-medium">Checkpoint 3/5</span>';
                    } else if (!isLocked) {
                        statusBadge = '<span class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded-full">Ready</span>';
                    }
                    
                    missionCard.innerHTML = `
                        <div class="relative">
                            <!-- Icon and Title on same row -->
                            <div class="flex items-start gap-3 mb-3">
                                <div class="flex-shrink-0">
                                    ${isCompleted ? '<i class="fas fa-check text-2xl text-black"></i>' : mission.icon ? `<i class="fas ${mission.icon} text-2xl text-black"></i>` : '<i class="fas fa-rocket text-2xl text-black"></i>'}
                                </div>
                                <div class="flex-1">
                                    <h3 class="text-lg font-semibold text-text-primary">${mission.title}</h3>
                                    <p class="text-sm text-text-secondary">Objective: ${objective.title}</p>
                                </div>
                                <!-- Arrow button in top right -->
                                <button class="p-2 hover:bg-gray-100 rounded transition-all" onclick="event.stopPropagation(); window.location.href='mission-detail.html?mission=${missionId}'">
                                    <i class="fas fa-arrow-right text-gray-400"></i>
                                </button>
                            </div>
                            
                            <!-- Status badge in top right corner -->
                            <div class="absolute top-0 right-12">
                                ${statusBadge}
                            </div>
                            
                            <!-- Content based on status -->
                            ${isActive ? `
                                <div class="mt-4">
                                    <p class="text-sm text-text-secondary mb-3">Next: ${mission.nextStep || 'Continue to next checkpoint'}</p>
                                    <!-- Checkpoint status in bottom left -->
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium text-warning">3/5 Checkpoints complete</span>
                                    </div>
                                </div>
                            ` : isCompleted ? `
                                <div class="mt-4">
                                    <p class="text-sm text-text-secondary">Completed successfully</p>
                                </div>
                            ` : `
                                <div class="mt-4">
                                    <div class="space-y-1">
                                        <p class="text-sm text-text-secondary">Est. time: ${mission.estimatedTime}</p>
                                        <p class="text-sm text-text-secondary">Difficulty: ${mission.difficulty}</p>
                                    </div>
                                </div>
                            `}
                        </div>
                    `;
                    
                    container.appendChild(missionCard);
                } else {
                    console.warn(`Mission not found: ${missionId}`);
                }
            });
            
            // If no missions were loaded, show a message
            if (container.children.length === 0) {
                const message = currentFilter === 'active' 
                    ? '<p class="text-text-secondary">No active missions. All missions have been completed!</p>'
                    : '<p class="text-text-secondary">No completed missions yet. Start working on your missions!</p>';
                container.innerHTML = message;
            }
        }

        function goBack() {
            window.location.href = 'flightplan.html';
        }
        
        // Toggle action dropdown
        function toggleDropdown() {
            const dropdown = document.getElementById('action-dropdown');
            dropdown.classList.toggle('hidden');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('action-dropdown');
            const button = event.target.closest('button[onclick="toggleDropdown()"]');
            
            if (!button && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });
        
        function filterMissions(filter) {
            currentFilter = filter;
            
            // Update button styles
            const activeBtn = document.getElementById('active-filter');
            const completedBtn = document.getElementById('completed-filter');
            
            if (filter === 'active') {
                activeBtn.className = 'px-4 py-2 bg-primary text-white rounded-lg transition-all';
                completedBtn.className = 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all';
            } else {
                activeBtn.className = 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all';
                completedBtn.className = 'px-4 py-2 bg-primary text-white rounded-lg transition-all';
            }
            
            // Reload missions with filter
            const urlParams = new URLSearchParams(window.location.search);
            const objectiveId = urlParams.get('objective') || 'idea-validation';
            const objective = objectiveData[objectiveId];
            if (objective) {
                loadMissions(objective.missions, objective);
            }
        }

        function startNextMission() {
            const nextMissionIndex = objective.progress;
            if (nextMissionIndex < objective.missions.length) {
                const nextMissionId = objective.missions[nextMissionIndex];
                window.location.href = `mission-detail.html?mission=${nextMissionId}`;
            }
        }

        // Open suggestion modal
        function openSuggestionModal() {
            document.getElementById('suggestion-modal').classList.remove('hidden');
            document.getElementById('suggestion-modal').classList.add('flex');
            document.getElementById('action-dropdown').classList.add('hidden');
            
            // Update objective name in modal
            const objectiveTitle = document.getElementById('objective-title').textContent;
            document.getElementById('modal-objective-name').textContent = objectiveTitle;
        }

        // Close suggestion modal
        function closeSuggestionModal() {
            document.getElementById('suggestion-modal').classList.add('hidden');
            document.getElementById('suggestion-modal').classList.remove('flex');
            document.getElementById('suggestion-title').value = '';
            document.getElementById('suggestion-description').value = '';
        }

        // Submit suggestion
        function submitSuggestion() {
            const title = document.getElementById('suggestion-title').value.trim();
            const description = document.getElementById('suggestion-description').value.trim();
            
            if (!title) {
                alert('Please enter a mission title');
                return;
            }
            
            // In a real app, this would send to backend
            alert(`Thank you for your suggestion!\n\nMission: ${title}\n\nWe'll review your suggestion and consider adding it to FoundersFleet.`);
            closeSuggestionModal();
        }

        // Initialize navigation
        initializeNavigation('flightplan');
        
        // Ensure missions data is loaded
        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                // Re-initialize page to ensure all data is loaded
                initializePage();
            }, 100);
        });
    </script>

    <!-- Suggestion Modal -->
    <div id="suggestion-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-md w-full p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-semibold text-text-primary">Suggest New Mission</h3>
                <button onclick="closeSuggestionModal()" class="text-gray-400 hover:text-gray-600 transition-all">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <p class="text-sm text-text-secondary mb-4">
                Have an idea for a mission that would help founders with <span id="modal-objective-name" class="font-medium">this objective</span>? 
                We'd love to hear it!
            </p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-text-primary mb-1">Mission Title</label>
                    <input type="text" id="suggestion-title" 
                           placeholder="e.g., 'Run A/B Tests on Landing Page'" 
                           class="w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-text-primary mb-1">Description (optional)</label>
                    <textarea id="suggestion-description" rows="3" 
                              placeholder="Briefly describe what this mission would involve..."
                              class="w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none"></textarea>
                </div>
                
                <div class="text-xs text-text-secondary">
                    <i class="fas fa-info-circle mr-1"></i>
                    Your suggestion will be reviewed by the FoundersFleet team
                </div>
            </div>
            
            <div class="flex gap-3 mt-6">
                <button onclick="closeSuggestionModal()" 
                        class="flex-1 px-4 py-2 border border-border rounded-lg hover:bg-gray-50 transition-all">
                    Cancel
                </button>
                <button onclick="submitSuggestion()" 
                        class="flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover transition-all">
                    Submit Suggestion
                </button>
            </div>
        </div>
    </div>
</body>
</html>